<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CineGenesis | The Creative Co-Director</title>
    
    <meta name="theme-color" content="#030303">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- FONTS: Inter (UI) + Manrope (Headers) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Manrope:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- LIBRARIES -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], display: ['Manrope', 'sans-serif'] },
                    colors: {
                        void: '#030303',       
                        surface: '#0A0A0A',    
                        tungsten: '#FACC15',      
                        neural: '#3B82F6',         
                        subtext: '#525252',
                        'data-green': '#10B981',    
                    },
                    animation: {
                        'fade-in': 'fadeIn 1s ease-out forwards',
                        'slide-up': 'slideUp 0.8s ease-out forwards',
                        'pulse-slow': 'pulse 4s infinite',
                        'ignite': 'ignite 2s cubic-bezier(0.22, 1, 0.36, 1) forwards',
                        'studio-enter': 'studioEnter 1s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'float': 'float 10s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: 0 }, '100%': { opacity: 1 } },
                        slideUp: { '0%': { opacity: 0, transform: 'translateY(20px)' }, '100%': { opacity: 1, transform: 'translateY(0)' } },
                        ignite: { '0%': { transform: 'scale(1)', filter: 'brightness(1)' }, '50%': { transform: 'scale(1.05)', filter: 'brightness(2)' }, '100%': { transform: 'scale(1)', filter: 'brightness(1)' } },
                        studioEnter: { '0%': { opacity: 0, transform: 'scale(0.98)' }, '100%': { opacity: 1, transform: 'scale(1)' } },
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-20px)' } }
                    }
                }
            }
        }
    </script>

    <style>
        /* UHD RESET */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        html, body { 
            margin: 0; padding: 0; 
            background-color: #030303; 
            color: #E5E5E5; 
            font-family: 'Inter', sans-serif; 
            overflow: hidden; 
            height: 100dvh; width: 100vw; 
            -webkit-font-smoothing: antialiased; 
        }
        #root { width: 100%; height: 100%; }
        
        .dream-input { background: transparent; border: none; outline: none; font-family: 'Manrope', sans-serif; font-weight: 300; color: #E5E5E5; text-align: left; }
        .dream-input::placeholder { color: #404040; opacity: 1; transition: opacity 0.5s; font-weight: 300; }
        .dream-input:focus::placeholder { opacity: 0; }

        .ignite-btn { background: white; color: black; font-family: 'Manrope', sans-serif; font-weight: 800; letter-spacing: 0.05em; transition: all 0.4s; }
        .ignite-btn:hover { transform: scale(1.02); box-shadow: 0 0 40px rgba(255,255,255,0.15); }
        
        .pro-panel { background: rgba(14, 14, 16, 0.95); border: 1px solid rgba(255, 255, 255, 0.08); box-shadow: 0 4px 20px rgba(0,0,0,0.5); }
        .nav-item { cursor: pointer; transition: all 0.3s; opacity: 0.5; }
        .nav-item:hover, .nav-item.active { opacity: 1; color: white; border-bottom: 1px solid white; }
        
        .custom-scrollbar::-webkit-scrollbar { display: none; }
        .module-card:hover { background: rgba(255, 255, 255, 0.08); border-color: rgba(255, 255, 255, 0.2); transform: translateY(-1px); }
        
        /* Dream Stream Overlay */
        .dream-stream-item {
            position: absolute;
            opacity: 0.1;
            filter: blur(2px) grayscale(100%);
            transition: all 1s ease;
            pointer-events: none;
        }
        .dream-stream-item.active {
            opacity: 0.4;
            filter: blur(0px) grayscale(0%);
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // --- KEYS ---
        const SUPABASE_URL = 'https://wiaimzbdyouubsbasphp.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndpYWltemJkeW91dWJzYmFzcGhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzOTMxNzksImV4cCI6MjA4MTk2OTE3OX0.houU04xQmnV8bagmjeaI91F2Vqr5aQ6deJi_-H_42k4';
        
        const useGlobalState = () => {
            const [flux, setFlux] = useState(0);
            useEffect(() => {
                try {
                   if (window.supabase) {
                       const client = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                       setFlux(12400); 
                   }
                } catch(e) {}
            }, []);
            return { flux };
        };

        const Icon = ({ name, size = 20, className, onClick }) => {
            useEffect(() => { if (window.lucide) window.lucide.createIcons(); }, [name]); 
            return <i data-lucide={name} className={className} style={{ width: size, height: size, display: 'inline-block', cursor: onClick ? 'pointer' : 'default' }} onClick={onClick}></i>;
        };

        // --- STAGE 1: THE DREAM INTERFACE (With Dream Stream & Telemetry) ---
        const DreamInterface = ({ onIgnite }) => {
            const [input, setInput] = useState("");
            const [showTriggers, setShowTriggers] = useState(false);
            const [isIgniting, setIsIgniting] = useState(false);
            const [harvestStatus, setHarvestStatus] = useState("");
            const [telemetry, setTelemetry] = useState("Awaiting Input...");
            const [activeDreamImage, setActiveDreamImage] = useState(null);

            // Cognitive Telemetry Logic
            useEffect(() => { 
                if (input.length > 2) {
                    setShowTriggers(true);
                    
                    // Simulate SNE "Thinking"
                    const lower = input.toLowerCase();
                    if (lower.includes("rain")) {
                        setTelemetry("Detected: Precipitation -> Deploying Volumetric Fog Nodes...");
                        setActiveDreamImage("https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=500&q=80");
                    } else if (lower.includes("cyber")) {
                        setTelemetry("Detected: Sci-Fi Genre -> Loading Neon LUTs & Glitch FX...");
                         setActiveDreamImage("https://images.unsplash.com/photo-1605647540924-852290f6b0d5?w=500&q=80");
                    } else if (lower.includes("sun")) {
                        setTelemetry("Detected: High Key Lighting -> Calibrating Golden Hour HDR...");
                         setActiveDreamImage("https://images.unsplash.com/photo-1495616811223-4d98c6e9d856?w=500&q=80");
                    } else {
                        setTelemetry("Analyzing Semantic Intent...");
                    }
                } else {
                    setShowTriggers(false);
                    setTelemetry("Awaiting Input...");
                    setActiveDreamImage(null);
                }
            }, [input]);

            const handleIgnite = () => {
                setIsIgniting(true);
                setTimeout(() => setHarvestStatus("Optimizing Neural Prompt..."), 500);
                setTimeout(() => setHarvestStatus("Crystallizing Assets to Library..."), 1500);
                setTimeout(() => setHarvestStatus("Minting Voice Model..."), 2500);
                setTimeout(() => onIgnite(input), 4000);
            };

            if (isIgniting) return (
                <div className="h-full w-full flex flex-col items-center justify-center bg-void animate-ignite">
                    <div className="w-16 h-16 border-4 border-t-white border-white/10 rounded-full animate-spin mb-8"></div>
                    <h2 className="text-xl font-display font-bold text-white tracking-widest uppercase">{harvestStatus}</h2>
                    <p className="text-[10px] text-gray-600 font-mono mt-2 uppercase tracking-[0.3em]">System Locking</p>
                </div>
            );

            return (
                <div className="h-full w-full flex flex-col items-center justify-center relative bg-void overflow-hidden">
                    
                    {/* THE DREAM STREAM (Ghost Images) */}
                    {activeDreamImage && (
                        <div className="absolute top-1/4 right-1/4 w-64 h-64 border border-white/10 rounded-xl overflow-hidden dream-stream-item active animate-float">
                            <img src={activeDreamImage} className="w-full h-full object-cover" />
                            <div className="absolute bottom-2 left-2 bg-black/60 px-2 py-1 text-[8px] font-mono text-white backdrop-blur">PRE-VIZ</div>
                        </div>
                    )}

                    <div className="w-full max-w-4xl px-6 md:px-12 flex flex-col items-start relative z-10">
                        <h1 className="text-5xl md:text-8xl font-display font-bold text-white mb-12 tracking-tighter animate-fade-in leading-none drop-shadow-2xl">
                            Direct Your Dreams.
                        </h1>

                        <div className="w-full relative mb-16 animate-slide-up border-b border-white/10 pb-6 hover:border-white/30 transition-all duration-500" style={{animationDelay: '0.1s'}}>
                            <div className="flex justify-between items-end">
                                <input 
                                    type="text" value={input} onChange={(e) => setInput(e.target.value)}
                                    placeholder="Describe your scene..." 
                                    className="dream-input text-2xl md:text-4xl w-full focus:border-none"
                                    autoFocus
                                />
                                <span className="text-[10px] font-mono text-gray-600 uppercase tracking-widest whitespace-nowrap ml-6 mb-2 opacity-50">
                                    Writing for Input
                                </span>
                            </div>
                        </div>

                        <div className="w-full flex items-center justify-between h-20">
                            <div className={`transition-all duration-700 ${showTriggers ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}`}>
                                <button onClick={handleIgnite} className="ignite-btn px-10 py-5 rounded-full text-xs uppercase flex items-center gap-3 shadow-2xl">
                                    Ignite Engine <Icon name="chevron-right" size={16} />
                                </button>
                            </div>
                            
                            {/* COGNITIVE TELEMETRY */}
                            <div className={`text-[10px] font-mono text-neural uppercase tracking-[0.1em] transition-opacity duration-1000 flex items-center gap-2 ${input ? 'opacity-100' : 'opacity-0'}`}>
                                <span className="w-1.5 h-1.5 bg-neural rounded-full animate-pulse"></span>
                                {telemetry}
                            </div>
                            
                            <div className={`flex gap-4 transition-all duration-700 delay-100 ${showTriggers ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}`}>
                                <div className="flex items-center gap-2 px-6 py-3 rounded-full border border-white/5 bg-surface/50 text-gray-400 text-[10px] font-bold uppercase tracking-wider cursor-pointer hover:border-white/20 hover:text-white hover:bg-surface transition-all backdrop-blur-md">
                                    <Icon name="layout-grid" size={14} /> Menus
                                </div>
                                <div className="flex items-center gap-2 px-6 py-3 rounded-full border border-white/5 bg-surface/50 text-gray-400 text-[10px] font-bold uppercase tracking-wider cursor-pointer hover:border-white/20 hover:text-white hover:bg-surface transition-all backdrop-blur-md">
                                    <Icon name="box" size={14} /> Assets
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- STAGE 2: THE CO-DIRECTOR ECOSYSTEM ---
        const MasterStudio = ({ prompt, flux }) => {
            const [view, setView] = useState('studio'); 
            const [activeFidelity, setActiveFidelity] = useState('4K');
            
            // Camera Simulator Logic
            const camType = prompt.toLowerCase().includes('drone') ? 'DRONE ASCEND' : 
                            prompt.toLowerCase().includes('run') ? 'HANDHELD SHAKY' : 
                            'STEADICAM TRACKING';
            const lensType = prompt.toLowerCase().includes('wide') ? '16MM' : 
                             prompt.toLowerCase().includes('portrait') ? '85MM' : 
                             '35MM ANAMORPHIC';

            return (
                <div className="h-full w-full bg-[#050505] text-white flex flex-col p-6 animate-studio-enter">
                    
                    {/* Header */}
                    <div className="flex justify-between items-center mb-6">
                        <div className="flex items-center gap-6">
                            <div className="flex items-center gap-3">
                                <div className="w-2 h-2 rounded-full bg-green-500 shadow-[0_0_12px_#22c55e]"></div>
                                <span className="text-[10px] font-mono font-bold uppercase tracking-widest text-gray-400">Online</span>
                            </div>
                            <div className="h-4 w-px bg-white/10"></div>
                            <div className="flex items-center gap-4">
                                <span onClick={() => setView('studio')} className={`nav-item text-[10px] font-bold uppercase tracking-widest ${view==='studio'?'active':''}`}>Studio</span>
                                <span onClick={() => setView('arena')} className={`nav-item text-[10px] font-bold uppercase tracking-widest ${view==='arena'?'active':''}`}>Arena</span>
                                <span onClick={() => setView('sync')} className={`nav-item text-[10px] font-bold uppercase tracking-widest ${view==='sync'?'active':''}`}>Lens</span>
                            </div>
                        </div>

                        <div className="flex items-center gap-4">
                             <button className="flex items-center gap-2 px-4 py-1.5 rounded border border-white/10 text-[10px] font-bold uppercase hover:bg-white/5 transition-all text-gray-300">
                                <Icon name="code" size={12} /> Code
                             </button>
                             <button className="flex items-center gap-2 px-4 py-1.5 rounded bg-white text-black text-[10px] font-bold uppercase hover:bg-gray-200 transition-all">
                                <Icon name="play" size={12} className="fill-black" /> Preview
                             </button>
                             <div className="w-px h-4 bg-white/10 mx-2"></div>
                             <div className="flex items-center gap-2 text-[10px] font-mono text-tungsten bg-tungsten/10 px-3 py-1 rounded border border-tungsten/20">
                                <Icon name="zap" size={10} className="fill-current"/> {flux.toLocaleString()}
                             </div>
                        </div>
                    </div>

                    {/* Content */}
                    <div className="flex-1 overflow-hidden relative">
                        {view === 'studio' && (
                            <div className="h-full grid grid-cols-12 gap-6 min-h-0 animate-fade-in">
                                {/* LEFT COL */}
                                <div className="col-span-3 flex flex-col gap-4">
                                    <div className="bg-[#0A0A0A] border border-white/5 rounded-2xl p-6 flex-1 flex flex-col shadow-2xl relative overflow-hidden group">
                                        <div className="absolute top-0 right-0 p-12 bg-white/5 rounded-full blur-3xl group-hover:bg-white/10 transition-colors duration-1000"></div>
                                        <h3 className="text-[10px] font-bold text-subtext uppercase tracking-widest mb-4 z-10">Screenplay</h3>
                                        <p className="font-display text-2xl text-white leading-tight z-10 antialiased">"{prompt}"</p>
                                        <div className="mt-auto pt-6 border-t border-white/5 z-10 flex items-center gap-2 text-[10px] text-neural font-mono"><Icon name="check-circle-2" size={12} /> Script Optimized</div>
                                    </div>
                                    <div className="bg-[#0A0A0A] border border-white/5 rounded-2xl p-6 h-1/2 flex flex-col shadow-2xl">
                                         <h3 className="text-[10px] font-bold text-subtext uppercase tracking-widest mb-4">Modules</h3>
                                         <div className="space-y-3">
                                            <div className="module-card flex items-center justify-between p-4 bg-surface rounded-xl border border-white/5 cursor-pointer"><div className="flex items-center gap-3"><Icon name="monitor" size={16} className="text-gray-300"/><span className="text-xs font-bold">4K Neural Render</span></div><div className="w-1.5 h-1.5 bg-green-500 rounded-full shadow-[0_0_8px_#22c55e]"></div></div>
                                            <div className="module-card flex items-center justify-between p-4 bg-surface rounded-xl border border-white/5 cursor-pointer"><div className="flex items-center gap-3"><Icon name="speaker" size={16} className="text-gray-300"/><span className="text-xs font-bold">Dolby Atmos</span></div><div className="w-1.5 h-1.5 bg-green-500 rounded-full shadow-[0_0_8px_#22c55e]"></div></div>
                                         </div>
                                         <button className="w-full mt-auto py-4 bg-white text-black font-extrabold text-[10px] uppercase rounded-xl hover:bg-gray-200 transition-colors tracking-wider flex items-center justify-center gap-2 shadow-lg shadow-white/10">
                                            <Icon name="download" size={14} /> Export Master
                                        </button>
                                    </div>
                                </div>

                                {/* RIGHT COL */}
                                <div className="col-span-9 flex flex-col gap-6">
                                    {/* DIRECTOR'S VIEWFINDER (Live Camera Sim) */}
                                    <div className="flex-1 bg-black border border-white/10 rounded-2xl relative overflow-hidden group shadow-2xl">
                                        <div className="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-60"></div>
                                        <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-indigo-900/10 via-black to-black opacity-40"></div>
                                        <div className="absolute inset-0 flex items-center justify-center"><div className="w-24 h-24 rounded-full bg-white/5 backdrop-blur-xl border border-white/10 flex items-center justify-center hover:scale-105 hover:bg-white/10 transition-all cursor-pointer shadow-2xl"><Icon name="play" size={36} className="fill-white ml-2 opacity-90" /></div></div>
                                        
                                        {/* Dynamic Camera Data */}
                                        <div className="absolute top-6 left-6 flex items-center gap-3">
                                            <div className="px-3 py-1 rounded-full bg-black/60 backdrop-blur border border-white/10 text-[10px] font-mono text-gray-400 flex items-center gap-2">
                                                <div className="w-1 h-1 bg-red-500 rounded-full animate-pulse"></div> CAM: {camType}
                                            </div>
                                            <div className="px-3 py-1 rounded-full bg-black/60 backdrop-blur border border-white/10 text-[10px] font-mono text-gray-400">
                                                LENS: {lensType}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Timeline */}
                                    <div className="h-36 bg-[#0A0A0A] border border-white/5 rounded-2xl p-6 flex flex-col justify-center relative overflow-hidden shadow-xl">
                                        <div className="flex justify-between items-end mb-4 relative z-10"><div className="flex items-center gap-2"><Icon name="activity" size={12} className="text-gray-600"/><span className="text-[10px] font-bold uppercase text-subtext tracking-widest">Master Sequence</span></div><span className="text-[10px] font-mono text-white/80">00:00:00 / 00:04:12:00</span></div>
                                        <div className="w-full h-12 bg-[#050505] rounded-xl overflow-hidden flex relative z-10 border border-white/5"><div className="absolute left-1/3 top-0 bottom-0 w-0.5 bg-white z-20 shadow-[0_0_15px_white]"></div><div className="w-1/3 h-full bg-emerald-500/20 border-r border-emerald-500/30 flex items-center px-2"><span className="text-[9px] font-mono text-emerald-500">VIDEO_01</span></div><div className="w-1/4 h-full bg-blue-500/20 border-r border-blue-500/30 flex items-center px-2"><span className="text-[9px] font-mono text-blue-500">AUDIO_MAIN</span></div><div className="w-1/5 h-full bg-amber-500/20 border-r border-amber-500/30 flex items-center px-2"><span className="text-[9px] font-mono text-amber-500">SFX_LAYER</span></div></div>
                                        <div className="absolute inset-0 opacity-5" style={{backgroundImage: 'linear-gradient(#222 1px, transparent 1px), linear-gradient(90deg, #222 1px, transparent 1px)', backgroundSize: '20px 20px'}}></div>
                                    </div>
                                </div>
                            </div>
                        )}
                        {/* VIEW 2: ARENA (Placeholders Fixed with Real Layouts) */}
                        {view === 'arena' && (
                            <div className="flex flex-col items-center justify-center h-full animate-fade-in p-12">
                                <h2 className="text-3xl font-display font-bold mb-8">Creative Esports Arena</h2>
                                <div className="grid grid-cols-2 gap-8 w-full max-w-4xl">
                                    <div className="bg-[#1A1A1A] rounded-2xl border border-red-500/30 p-8 relative overflow-hidden group hover:border-red-500/50 transition-all cursor-pointer">
                                        <div className="absolute top-4 right-4 text-red-500 font-bold text-xs uppercase animate-pulse">Live Battle</div>
                                        <div className="w-20 h-20 rounded-full bg-gray-800 mx-auto mb-4 border-2 border-red-500 shadow-[0_0_20px_rgba(239,68,68,0.2)]"></div>
                                        <h3 className="text-xl font-bold text-center">Aria Voss</h3>
                                        <p className="text-xs text-gray-500 text-center mt-2 font-mono">Rendering: "Cyberpunk Chase"</p>
                                    </div>
                                    <div className="bg-[#1A1A1A] rounded-2xl border border-blue-500/30 p-8 relative overflow-hidden group hover:border-blue-500/50 transition-all cursor-pointer">
                                        <div className="w-20 h-20 rounded-full bg-gray-800 mx-auto mb-4 border-2 border-blue-500 shadow-[0_0_20px_rgba(59,130,246,0.2)]"></div>
                                        <h3 className="text-xl font-bold text-center">Kaelen Chen</h3>
                                        <p className="text-xs text-gray-500 text-center mt-2 font-mono">Rendering: "Neo-Noir Detective"</p>
                                    </div>
                                </div>
                            </div>
                        )}
                        {/* VIEW 3: SYNC */}
                        {view === 'sync' && (
                            <div className="flex flex-col items-center justify-center h-full animate-fade-in">
                                <div className="p-12 border border-white/10 rounded-3xl bg-[#0A0A0A] text-center shadow-2xl relative overflow-hidden">
                                    <div className="absolute inset-0 bg-gradient-to-br from-purple-500/5 to-transparent"></div>
                                    <div className="w-24 h-24 rounded-full bg-white/5 flex items-center justify-center mx-auto mb-8 border border-white/10">
                                        <Icon name="qr-code" size={48} className="text-tungsten" />
                                    </div>
                                    <h2 className="text-2xl font-bold mb-2">Genesis Lens</h2>
                                    <p className="text-sm text-gray-500 mb-8 max-w-xs mx-auto">Scan to bridge your mobile device and capture real-world textures.</p>
                                    <button className="px-8 py-3 bg-white text-black font-bold text-xs uppercase rounded-lg hover:bg-gray-200 transition-colors">Generate Code</button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [mode, setMode] = useState('dream');
            const [prompt, setPrompt] = useState("");
            const { flux } = useGlobalState();
            const handleIgnite = (p) => { setPrompt(p); setMode('studio'); };

            return (
                <div className="w-full h-full">
                    {mode === 'dream' ? <DreamInterface onIgnite={handleIgnite} /> : <MasterStudio prompt={prompt} flux={flux} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
